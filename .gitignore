# Compiled Object files
*.slo
*.lo
*.o
*.obj

# Precompiled Headers
*.gch
*.pch

# Compiled Dynamic libraries
*.so
*.dylib
*.dll

# Fortran module files
*.mod
*.smod

# Compiled Static libraries
*.lai
*.la
*.a
*.lib

# Executables
*.exe
*.out
*.app

{"status":"fail","message":"Your version of Instagram is out of date. Please upgrade your app in the Play Store to log in to Instagram."}

 {
                             // If we get result, it always return status ok. Otherwise, exception will occur.                                           
                             var responseData = streamReader.ReadToEnd();
-                            return JsonConvert.DeserializeObject<UpdateProfileResult>(responseData);                            
+                            return JsonConvert.DeserializeObject<UpdateProfileResult>(responseData);
                         }
                     }
                 }
@@ -246,15 +246,16 @@ public UpdateProfileResult SetUsername(string newUsername)
         /// <returns></returns>
         public FollowResult Follow(string username)
         {
+
+            Debug.WriteLine("Following " + username);
+            var publicInfo = GetPublicInfo(username);
+            var request = HttpRequestBuilder.Post($"https://www.instagram.com/web/friendships/{publicInfo.user.id}/follow/", mCoockieC);
+            request.Referer = $"https://www.instagram.com/{publicInfo.user.username}/";
+            request.Headers["X-CSRFToken"] = mCoockieC.GetCookies(new Uri("https://www.instagram.com"))["csrftoken"].Value;
+            request.Headers["X-Instagram-AJAX"] = "1";
+            request.Headers["X-Requested-With"] = "XMLHttpRequest";
             try
             {
-                Debug.WriteLine("Following " + username);
-                var publicInfo = GetPublicInfo(username);
-                var request = HttpRequestBuilder.Post($"https://www.instagram.com/web/friendships/{publicInfo.user.id}/follow/", mCoockieC);
-                request.Referer = $"https://www.instagram.com/{publicInfo.user.username}/";
-                request.Headers["X-CSRFToken"] = mCoockieC.GetCookies(new Uri("https://www.instagram.com"))["csrftoken"].Value;
-                request.Headers["X-Instagram-AJAX"] = "1";
-                request.Headers["X-Requested-With"] = "XMLHttpRequest";
                 using (var response = request.GetResponse() as HttpWebResponse)
                 {
                     mCoockieC.Add(response.Cookies);
@@ -296,23 +297,31 @@ public LikeResult Like(string postId)
             request.Headers["X-CSRFToken"] = mCoockieC.GetCookies(new Uri("https://www.instagram.com"))["csrftoken"].Value;
             request.Headers["X-Instagram-AJAX"] = "1";
             request.Headers["X-Requested-With"] = "XMLHttpRequest";
-            using (var response = request.GetResponse() as HttpWebResponse)
+            try
             {
-                mCoockieC.Add(response.Cookies);
-                if (request.HaveResponse)
+                using (var response = request.GetResponse() as HttpWebResponse)
                 {
-                    using (var responseStream = response.GetResponseStream())
-                    using (var streamReader = new StreamReader(responseStream))
+                    mCoockieC.Add(response.Cookies);
+                    if (request.HaveResponse)
                     {
-                        var responseData = streamReader.ReadToEnd();
-                        return JsonConvert.DeserializeObject<Models.LikeResult>(responseData);
+                        using (var responseStream = response.GetResponseStream())
+                        using (var streamReader = new StreamReader(responseStream))
+                        {
+                            var responseData = streamReader.ReadToEnd();
+                            return JsonConvert.DeserializeObject<Models.LikeResult>(responseData);
+                        }
+                    }
+                    else
+                    {
+                        throw new WebException("no response");
                     }
-                }
-                else
-                {
-                    throw new WebException("no response");
                 }
             }
+            catch (Exception ex)
+            {
+                Debug.WriteLine(ex.Message);
+                throw ex;
+            }
         }
 
         /// <summary>
@@ -332,26 +341,35 @@ public CommentResult Comment(string postId, string comment)
             request.Headers["X-CSRFToken"] = mCoockieC.GetCookies(new Uri("https://www.instagram.com"))["csrftoken"].Value;
             request.Headers["X-Instagram-AJAX"] = "1";
             request.Headers["X-Requested-With"] = "XMLHttpRequest";
-            using (var stream = request.GetRequestStream())
-            {
-                stream.Write(content, 0, content.Length);
-            }
-            using (var response = request.GetResponse() as HttpWebResponse)
+            try
             {
-                mCoockieC.Add(response.Cookies);
-                if (request.HaveResponse)
+                using (var stream = request.GetRequestStream())
                 {
-                    using (var responseStream = response.GetResponseStream())
-                    using (var streamReader = new StreamReader(responseStream))
-                    {
-                        var responseData = streamReader.ReadToEnd();
-                        return JsonConvert.DeserializeObject<Models.CommentResult>(responseData);
-                    }
+                    stream.Write(content, 0, content.Length);
                 }
-                else
+                using (var response = request.GetResponse() as HttpWebResponse)
                 {
-                    throw new WebException("no response");
+                    mCoockieC.Add(response.Cookies);
+                    if (request.HaveResponse)
+                    {
+                        using (var responseStream = response.GetResponseStream())
+                        using (var streamReader = new StreamReader(responseStream))
+                        {
+                            var responseData = streamReader.ReadToEnd();
+                            return JsonConvert.DeserializeObject<Models.CommentResult>(responseData);
+                        }
+                    }
+                    else
+                    {
+                        throw new WebException("no response");
+                    }
                 }
+
+            }
+            catch (Exception ex)
+            {
+                Debug.WriteLine(ex.Message);
+                throw ex;
             }
         }
 
@@ -360,23 +378,46 @@ public CommentResult Comment(string postId, string comment)
         /// </summary>
         /// <param name="postId"></param>
         /// <returns></returns>
-        public bool Report(string postId)
+        public ReportResult Report(string postId, ReportReasonId reasonId)
         {
-            // I'm a good man, i don't test report XD
-            throw new NotImplementedException();
-        }
-
-        /// <summary>
-        /// Allow register new user account -- return Models.RegisterResult
-        /// </summary>
-        /// <param name="email"></param>
-        /// <param name="fullName"></param>
-        /// <param name="username"></param>
-        /// <param name="password"></param>
-        /// <returns></returns>
-        public bool Register(string email, string fullName, string username, string password)
-        {
-            throw new NotImplementedException();
+            var data = "reason_id=" + (int)reasonId;
+            var content = Encoding.ASCII.GetBytes(data);
+            var request = HttpRequestBuilder.Post($"https://www.instagram.com/media/{postId}/flag/", mCoockieC);
+            request.ContentType = "application/x-www-form-urlencoded";
+            request.Referer = $"https://www.instagram.com/";
+            request.ContentLength = content.Length;
+            request.Headers["X-CSRFToken"] = mCoockieC.GetCookies(new Uri("https://www.instagram.com"))["csrftoken"].Value;
+            request.Headers["X-Instagram-AJAX"] = "1";
+            request.Headers["X-Requested-With"] = "XMLHttpRequest";
+            try
+            {
+                using (var stream = request.GetRequestStream())
+                {
+                    stream.Write(content, 0, content.Length);
+                }
+                using (var response = request.GetResponse() as HttpWebResponse)
+                {
+                    mCoockieC.Add(response.Cookies);
+                    if (request.HaveResponse)
+                    {
+                        using (var responseStream = response.GetResponseStream())
+                        using (var streamReader = new StreamReader(responseStream))
+                        {
+                            var responseData = streamReader.ReadToEnd();
+                            return JsonConvert.DeserializeObject<ReportResult>(responseData);
+                        }
+                    }
+                    else
+                    {
+                        throw new WebException("no response");
+                    }
+                }
+            }
+            catch (Exception ex)
+            {
+                Debug.WriteLine(ex.Message);
+                throw ex;
+            }
         }
 
         /// <summary>
3 InstagramUser/InstagramUser.csproj
@@ -48,13 +48,14 @@
   </ItemGroup>
   <ItemGroup>
     <Compile Include="HttpRequestBuilder.cs" />
-    <Compile Include="Instaguser.cs" />
+    <Compile Include="InstagamUser.cs" />
     <Compile Include="Models\CommentResult.cs" />
     <Compile Include="Models\ProfileResult.cs" />
     <Compile Include="Models\FollowResult.cs" />
     <Compile Include="Models\LikeResult.cs" />
     <Compile Include="Models\LoginResult.cs" />
     <Compile Include="Models\PublicInfoResult.cs" />
+    <Compile Include="Models\ReportResult.cs" />
     <Compile Include="Models\UpdateProfileResult.cs" />
     <Compile Include="Program.cs" />
     <Compile Include="Properties\AssemblyInfo.cs" />
18 InstagramUser/Models/ReportResult.cs
@@ -0,0 +1,18 @@
+namespace InstagramUser.Models
+{
+    public class ReportResult
+    {        
+        public string status { get; set; }
+    }
+
+    public enum ReportReasonId
+    {
+        SpamOrScram = 1,
+        SelfHarm = 2,
+        DrugUse = 3,
+        NudityOrPornography = 4,
+        GraphicViolence = 5,
+        HateSpeechOrSymbol = 6,
+        HarassmentOrBullying = 7
+    }
+}
17 InstagramUser/Program.cs
@@ -1,12 +1,12 @@
 using System;
-using System.Collections.Generic;
 
 namespace InstagramUser
 {
     class Program
     {
         static void Main(string[] args)
-        {            
+        {
+            ReportTest();
             Console.ReadLine();
         }
 
@@ -96,5 +96,18 @@ static void CommentTest()
 
             Console.ReadLine();
         }
+
+        static void ReportTest()
+        {
+            var user = new InstagamUser("username", "password");        
+            var loginResult = user.LogIn();
+            if (loginResult.authenticated)
+            {
+                var commentResult = user.Report("1289832948493489827", Models.ReportReasonId.NudityOrPornography);
+                Console.WriteLine(commentResult.status);
+            }
+
+            Console.ReadLine();
+        }
     }

<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Newtonsoft.Json" version="9.0.1" targetFramework="net452" />
</packages>
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 14
VisualStudioVersion = 14.0.25420.1
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "InstagramUser", "InstagramUser\InstagramUser.csproj", "{548FA529-87B4-41FE-B9F9-579DFD9A6A20}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
EndGlobal
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 14
VisualStudioVersion = 14.0.25420.1
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "InstagramUser", "InstagramUser\InstagramUser.csproj", "{548FA529-87B4-41FE-B9F9-579DFD9A6A20}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{548FA529-87B4-41FE-B9F9-579DFD9A6A20}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
EndGlobal
param($installPath, $toolsPath, $package, $project)

# open json.net splash page on package install
# don't open if json.net is installed as a dependency

try
{
  $url = "http://www.newtonsoft.com/json/install?version=" + $package.Version
  $dte2 = Get-Interface $dte ([EnvDTE80.DTE2])

  if ($dte2.ActiveWindow.Caption -eq "Package Manager Console")
  {
    # user is installing from VS NuGet console
    # get reference to the window, the console host and the input history
    # show webpage if "install-package newtonsoft.json" was last input

    $consoleWindow = $(Get-VSComponentModel).GetService([NuGetConsole.IPowerConsoleWindow])

    $props = $consoleWindow.GetType().GetProperties([System.Reflection.BindingFlags]::Instance -bor `
      [System.Reflection.BindingFlags]::NonPublic)

    $prop = $props | ? { $_.Name -eq "ActiveHostInfo" } | select -first 1
    if ($prop -eq $null) { return }
  
    $hostInfo = $prop.GetValue($consoleWindow)
    if ($hostInfo -eq $null) { return }

    $history = $hostInfo.WpfConsole.InputHistory.History

    $lastCommand = $history | select -last 1

    if ($lastCommand)
    {
      $lastCommand = $lastCommand.Trim().ToLower()
      if ($lastCommand.StartsWith("install-package") -and $lastCommand.Contains("newtonsoft.json"))
      {
        $dte2.ItemOperations.Navigate($url) | Out-Null
      }
    }
  }
  else
  {
    # user is installing from VS NuGet dialog
    # get reference to the window, then smart output console provider
    # show webpage if messages in buffered console contains "installing...newtonsoft.json" in last operation

    $instanceField = [NuGet.Dialog.PackageManagerWindow].GetField("CurrentInstance", [System.Reflection.BindingFlags]::Static -bor `
      [System.Reflection.BindingFlags]::NonPublic)

    $consoleField = [NuGet.Dialog.PackageManagerWindow].GetField("_smartOutputConsoleProvider", [System.Reflection.BindingFlags]::Instance -bor `
      [System.Reflection.BindingFlags]::NonPublic)

    if ($instanceField -eq $null -or $consoleField -eq $null) { return }

    $instance = $instanceField.GetValue($null)

    if ($instance -eq $null) { return }

    $consoleProvider = $consoleField.GetValue($instance)
    if ($consoleProvider -eq $null) { return }

    $console = $consoleProvider.CreateOutputConsole($false)

    $messagesField = $console.GetType().GetField("_messages", [System.Reflection.BindingFlags]::Instance -bor `
      [System.Reflection.BindingFlags]::NonPublic)
    if ($messagesField -eq $null) { return }

    $messages = $messagesField.GetValue($console)
    if ($messages -eq $null) { return }

    $operations = $messages -split "=============================="

    $lastOperation = $operations | select -last 1

    if ($lastOperation)
    {
      $lastOperation = $lastOperation.ToLower()

      $lines = $lastOperation -split "`r`n"

      $installMatch = $lines | ? { $_.StartsWith("------- installing...newtonsoft.json ") } | select -first 1

      if ($installMatch)
      {
        $dte2.ItemOperations.Navigate($url) | Out-Null
      }
    }
  }
}
catch
{
  try
  {
    $pmPane = $dte2.ToolWindows.OutputWindow.OutputWindowPanes.Item("Package Manager")

    $selection = $pmPane.TextDocument.Selection
    $selection.StartOfDocument($false)
    $selection.EndOfDocument($true)

    if ($selection.Text.StartsWith("Attempting to gather dependencies information for package 'Newtonsoft.Json." + $package.Version + "'"))
    {
      # don't show on upgrade
      if (!$selection.Text.Contains("Removed package"))
      {
        $dte2.ItemOperations.Navigate($url) | Out-Null
      }
    }
  }
  catch
  {
    # stop potential errors from bubbling up
    # worst case the splash page won't open  
  }
}
requests==1.2.3
wsgiref==0.1.2
import functools

import requests


INSTAGRAM_API = 'https://api.instagram.com'


class BaseModel(object):

    @classmethod
    def parse_from_dict(cls, data):
        return cls(**data)


class Counts(BaseModel):

    def __init__(self, media, follows, followed_by):
        self.media = media
        self.follows = follows
        self.followed_by = followed_by


class User(BaseModel):

    def __init__(self, id, username, full_name, profile_picture,
                 bio, website, counts):
        if not isinstance(counts, Counts):
            raise TypeError('Counts must be an instance of Counts model')
        self.id = id
        self.username = username
        self.full_name = full_name
        self.profile_picture = profile_picture
        self.bio = bio
        self.website = website
        self.counts = counts


class Tag(BaseModel):

    def __init__(self, label):
        self.label = label


class Comment(BaseModel):

    def __init__(self, id, created_time, text, _from):
        self.id = id
        self.created_time = created_time
        self.text = text

        if not isinstance(_from, User):
            raise TypeError('From must be an instance of User model')
        self._from = _from


class Image(BaseModel):

    def __init__(self, type, url, width, height):
        self.type = type
        self.url = url
        self.width = width
        self.height = height


class Video(Image):
    pass


class Caption(BaseModel):

    def __init__(self, created_time, text, _from, id):
        self.created_time = created_time
        self.text = text
        self.id = id

        if not isinstance(_from, User):
            raise TypeError('From must be an instance of User model')
        self._from = _from


class Like(BaseModel):

    def __init__(self, username, profile_picture, id, full_name):
        self.username = username
        self.profile_picture = profile_picture
        self.id = id
        self.full_name = full_name


class Location(BaseModel):

    def __init__(self, id, latitude, longitude, name):
        self.id = id
        self.latitude = latitude
        self.longitude = longitude
        self.name = name


class Media(BaseModel):

    def __init__(self, attribution, tags, type, location, comments, filter,
                 created_time, link, likes, images, users_in_photo, caption,
                 user_has_liked, id, user, videos=None):
        self.attribution = attribution

        if not isinstance(tags, list):
            raise TypeError('Tags must be a list of Tag models')
        for tag in tags:
            if not isinstance(tag, Tag):
                raise TypeError('Tag must be an instance of Tag model')
        self.tags = tags
        self.type = type

        if not isinstance(comments, list):
            raise TypeError('Comments must be a list of Comment models')
        for comment in comments:
            if not isinstance(comment, Comment):
                raise TypeError('Comment must be an instance of Comment model')
        self.comments = comments
        self.filter = filter
        self.created_time = created_time
        self.link = link

        if not isinstance(likes, list):
            raise TypeError('Likes must be a list of Like models')
        for like in likes:
            if not isinstance(like, Like):
                raise TypeError('Like must be an instance of Like model')
        self.likes = likes

        if not isinstance(images, dict):
            raise TypeError('Images must be a dict of Image models')
        for image in images:
            if not isinstance(images.get(image), Image):
                raise TypeError('Image must be an instance of Image model')
        self.images = images

        if videos is not None:
            if not isinstance(videos, dict):
                raise TypeError('Videos must be a dict of Video models')
            for video in videos:
                if not isinstance(videos.get(video), Video):
                    raise TypeError('Video must be an instance of Video model')

        if not isinstance(users_in_photo, list):
            raise TypeError('Users in photo must be a list of User models')
        for user in users_in_photo:
            if not isinstance(user, User):
                raise TypeError('User must be an instance of User model')
        self.users_in_photo = users_in_photo

        if not isinstance(caption, Caption):
            raise TypeError('Caption must be an instance of Caption model')
        self.caption = caption

        self.user_has_liked = user_has_liked
        self.id = id

        if not isinstance(user, User):
            raise TypeError('User must be an instance of User model')
        self.user = user

        if location is not None:
            if not isinstance(location, Location):
                raise TypeError(
                    'Location must be an instance of Location model'
                )


def endpoint(uri, method='GET'):
    def _endpoint(ref):
        @functools.wraps(ref)
        def wrapper(**kwargs):
            req = requests.request(
                method,
                '%s%s' % (
                    INSTAGRAM_API,
                    uri % kwargs
                ),
                params=kwargs
            )
            if req.status_code != 200:
                raise requests.HTTPError(404)
            return ref(req)
        return wrapper
    return _endpoint


def _parse_medias(data):
    medias = []
    for media in data:
        tags = []
        for tag in media.get('tags'):
            tag = Tag.parse_from_dict(tag)
        comments = []
        for comment in media.get('comments'):
            comment = Comment.parse_from_dict(comment)
        likes = []
        for like in likes:
            like = Like.parse_from_dict(like)
        images = {}
        for image in media.get('images'):
            images.update({
                image: Image.parse_from_dict(
                    {'type': image}.update(media.get('images').get(image)))
            })
        videos = {}
        if media.get('videos', None) is not None:
            for video in media.get('videos'):
                videos.update({
                    video: Video.parse_from_dict(
                        {'type': video}.update(media.get('videos').get(video)))
                })
        if media.get('location', None) is not None:
            media.update({
                'location': Location.parse_from_dict(media.get('location'))
            })
        caption = Caption.parse_from_dict(media.get('caption'))
        user = User.parse_from_dict(media.get('user'))
        media.update({
            'tags': tags,
            'comments': comments,
            'likes': likes,
            'images': images,
            'caption': caption,
            'user': user
        })
        medias.append(Media.parse_from_dict(media))
    return medias


@endpoint('/v1/users/%(user_id)s')
def user_info(req):
    data = req.json().get('data')
    data.update({
        'counts': Counts.parse_from_dict(data.get('counts'))
    })
    user = User.parse_from_dict(data)
    return user


@endpoint('/v1/users/self/feed')
def user_self_feed(req):
    data = req.json().get('data')
    return _parse_medias(data)


@endpoint('/v1/users/%(user_id)s/media/recent')
def user_recent_media(req):
    data = req.json().get('data')
    return _parse_medias(data)


@endpoint('/v1/users/self/media/liked')
def user_self_liked(req):
    data = req.json().get('data')
    return _parse_medias(data)


@endpoint('/v1/users/search')
def users_search(req):
    data = req.json().get('data')
    users = []
    for user in data:
        users.append(User.parse_from_dict(data.get(user)))
return users
